# **채팅 서비스 요구사항 정의 (Requirements)** 

## **주요 기능**

- 로그인/회원가입
- 채팅방 개설
- 채팅방 참여
- 메세지 전송 (텍스트/이모지)
- 좋아요
- 답장
- 내 메세지 삭제

## **기능 상세**

  ### 1. **서비스 개요 및 접근 정책** 
    1) 만들고자 하는 것은 **간단한 ****채팅 서비스**이며, 반드시 로그인을 해야만 이용할 수 있다. 
    2) 로그인 상태가 아닐 때는 로그인 및 회원가입 페이지만 접근 가능하다. 
    3) 서비스 정책적으로는 채팅방 참여 개념이 없으며, **누구나 모든 채팅방에 메시지를 보낼 수 있고 확인할 수 있다**. 
  ### 2. **페이지 목록 및 기능** 
    1) **회원가입**: 닉네임, 이메일, 비밀번호, 비밀번호 확인을 입력한다. 
    2) **로그인**: 로그인 후 홈으로 이동하며, 홈에서는 채팅방 목록이 보인다. 
    3) **홈 (채팅방 목록)**: 헤더가 존재하며, 채팅방 추가 버튼이 존재한다. 
    4) **채팅방 추가**: 채팅방 이름 입력 후 제출 완료 시 홈으로 이동한다. 
    5) **채팅방 상세 (Rooms/[ID])**: 카카오톡과 같은 레이아웃으로 채팅을 표시한다. 
    6) **마이 페이지**: 닉네임을 저장할 수 있다. 
  ### 3. **채팅방 상세 기능 (메시지 관련)** 
    1) **메시지 전송**: 하단 입력창에 메시지를 입력 후 전송할 수 있다. 
    2) **메시지 유형**: 메시지는 **텍스트**와 **이모티콘** 두 가지 유형을 가진다. 
      - 이모티콘 메시지는 하단 입력창의 이모티콘 아이콘 클릭 후 팝업에서 선택하여 전송되며, 별도의 텍스트 영역 없이 이모티콘만 전송된다. 
    3) **메시지 메뉴**: 과거 메시지 우측에 메뉴 버튼이 표시되며, 클릭 시 메뉴가 나타난다. 
      - **내 메시지인 경우**: 삭제 기능이 있다. 
      - **타인 메시지인 경우**: 답장, 좋아요 기능이 있다. 
  ### 4. **삭제 기능 상세**: 
    1) 삭제 버튼 클릭 시 **삭제 모드**가 되며, 해당 메시지가 삭제 대상 메시지가 된다. 
    2) 삭제 모드에서는 내가 보낸 메시지들 옆에 체크 아이콘이 표시된다. 
    3) 삭제 대상 메시지는 **파란색**으로, 그 외는 **회색**으로 표시된다. 
    4) 체크 아이콘을 클릭하여 삭제 대상 여부를 토글(Toggle)할 수 있다. 
    5) 삭제 모드에서는 하단 입력창 대신 **취소** 및 **일괄 삭제** 버튼이 표시된다. 
    6) 삭제 대상 메시지가 없으면 일괄 삭제 버튼은 비활성화된다. 
    7) 삭제 완료 후 메시지 목록이 새로 고침된다. 
  ### 5. **답장 기능 상세**: 
    1) 답장 버튼 클릭 시 해당 메시지가 **답장 대상 메시지**가 된다. 
    2) 답장 대상 메시지가 존재하면 하단 입력창 상단에 해당 메시지의 **발신자 이름 + 내용**이 표시된다. 
    3) 추가 UI로 표시된 측면의 X 아이콘을 클릭하여 답장 대상 상태를 해제할 수 있다. 
    4) 답장 대상 메시지가 존재하는 상태에서 텍스트나 이모티콘 메시지를 전송하면, **답장 대상 메시지 정보도 데이터베이스에 함께 저장된다**. 
    5) 메시지 목록 표시 시, 저장된 답장 대상 메시지가 있다면 해당 메시지의 발신자 이름 + 내용을 함께 표시한다. 
    6) 저장이 성공하면 답장 대상 상태는 초기화된다. 
  ### 6. **좋아요 기능 상세**: 
    1) 좋아요 버튼을 누르면 해당 메시지에 좋아요가 추가된다. 
    2) 메시지 목록 표시 시, 좋아요가 있다면 **하트 아이콘과 개수**를 표시한다. 
    3) 이를 클릭하여 좋아요 상태를 토글할 수 있다. 
    4) 내가 좋아요한 메시지라면 하트 아이콘은 **핑크색**으로, 그 외에는 **회색**으로 표시된다. 
  ### 7. **인증 관련 주의사항**: 
    1) Supabase Auth를 사용할 때 클라이언트 사이드와 서버 사이드의 인증 방식을 꼼꼼히 체크하여 꼬이는 경우가 없도록 해야 한다. 


## 주의사항

- 상태로 관리해야하는 것만 상태로 관리된다.
- Flux 아키텍쳐가 반영된다.
- Context를 사용해 비즈니스로직을 중앙화 관리한다.
- 채팅 데이터 연동에 단순 polling으로 구현하세요. [주의] realtime, websocket 을 사용하지 않는다.